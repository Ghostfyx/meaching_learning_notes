# 第一章 向量、矩阵和数组

## 1. 简介

Numpy是Python机器学习技术栈的基础。Numpy能对机器学习中常用的数据结构向量——向量(Vector)、矩阵 (matrice)、张量(tensor)进行高效的操作。后续将介绍机器学习过程中常用的Numpy操作。

## 1.1 向量

### 1.1.1 向量简介

一个向量表示一组有序排列的数。通过次序中的索引，我们可以确定每个单独的数。通常我们赋予向量粗体的小写变量名称，比如xx。向量中的元素可以通过带脚标的斜体表示。向量$X$的第一个元素是$X_1$，第二个元素是$X_2$，以此类推。我们也会注明存储在向量中的元素的类型（实数、虚数等）。

### 1.1.2 创建一个向量

后续章节均没有代码展示。Numpy的主要数据结构是多维数组，创建向量只需要创建一维数组即可，PS：列向量需要n个元素个数为1的一位数组。

## 1.2 矩阵

矩阵是具有相同特征和维度的对象的集合，表现为一张二维数据表。其意义是一个对象表示为矩阵中的一行，一个特征表示为矩阵中的一列，每个特征都有数值型的取值。通常会赋予矩阵粗体的大写变量名称，比如$A$。

### 1.2.1 创建一个矩阵

实际上，Numpy提供了专用的数据结构来创建矩阵，但是我们不推荐使用，因为：

- 数组是Numpy的标准数组结构
- 大多数Numpy操作返回的是数组，而不是矩阵对象

## 1.3 稀疏矩阵

若数值为0的元素数目远远多于非0元素的数目，并且非0元素分布没有规律时，则称该矩阵为稀疏矩阵。稀疏举着可以利用零元素节约大量存储、运算和程序运行时间。最常用的稀疏矩阵存储格式为列压缩存储(compressed column storage, CCS) 或行压缩存储( ompressed row storage, CRS)。

**Tips 特殊矩阵**

如果非零元素的分布存在规律（如上三角矩阵、下三角矩阵、对角矩阵），则称该矩阵为[特殊矩阵](https://baike.baidu.com/item/特殊矩阵)。

### 1.3.1 创建一个稀疏矩阵

同创建矩阵，使用n维数组的方式。使用scipy可以压缩为稀疏行矩阵（Compressed Sparse Row，CSR）。输出结果如下：

```python
# scipy 使用三元组的方式表示稀疏矩阵，(行下标，列下表，元素值)
(1, 1)	1
(2, 1)	3
```

稀疏矩阵的类型很多，例如：压缩的稀疏列，表中表，键值对词典。在压缩行矩阵(CSR)中，$(1, 1)$和$(2,1)$表示非零元素的下标。与普通矩阵相比，增加稀疏矩阵的零元素不会改变稀疏矩阵的大小，两个稀疏矩阵的计算能够节省大量的计算成本。

## 1.4 选取元素

在向量和矩阵中选择元素，Numpy支持多种方式的元素选取：

- 下标索引，指定n维数组的元素下标选取；
- 切片索引

## 1.5 展示矩阵属性

分别使用shape，size，ndim展示矩阵的形状，大小和维度。

## 1.6 对多个元素同时使用操作

对数组多个元素同时使用某个函数。NumPy的vectorize函数将入参的函数作用于数组的全部元素或分组元素上，其本质是循环遍历之行入参函数，性能没有提高。NumPy的广播机制与vectorize函数有类似的地方。

**Tips NumPy 广播**

广播(Broadcast)是 numpy 对不同形状(shape)的数组进行数值计算的方式， 对数组的算术运算通常在相应的元素上进行。

两个数组 a 和 b 形状相同，即满足 **a.shape == b.shape**，那么 a*b 的结果就是 a 与 b 数组对应位相乘。这要求维数相同，且各维度的长度相同。2 个数组的形状不同时，numpy 将自动触发**广播机制**。

![](https://www.runoob.com/wp-content/uploads/2018/10/image0020619.gif)

广播的规则如下：

- 让所有输入数组都向其中形状最长的数组看齐，形状中不足的部分都通过在前面加 1 补齐。
- 输出数组的形状是输入数组形状的各个维度上的最大值
- 如果输入数组的某个维度和输出数组的对应维度的长度相同或者其长度为 1 时，这个数组能够用来计算，否则出错。
- 当输入数组的某个维度的长度为 1 时，沿着此维度运算时都用此维度上的第一组值。

## 1.7 最大值和最小值

使用NumPy的min和max方法找到数据最大，最小值。np.min(data, axis)，np.max(data, axis)。axis为可选参数，axis为空表示整个二维数组最大/最小元素，axis = 1表示每一行最大/最小元素，axis=1表示每一列最大/最小元素。

## 1.8 平均值、方差和标准差

使用NumPy的mean( )，var( )，std( )计算均值，方差和标准差，用于描述性统计值。 

## 1.9 矩阵变形

使用NumPy的reshape方法在不改变矩阵元素的情况下，改变矩阵的行数和列数。

## 1.10 转置向量或矩阵

使用T方法转置矩阵或向量，即行向量变为列向量。

## 1.11 展开一个矩阵

使用Numpy的flatten方法将矩阵展开为一维数组。

## 1.12 计算矩阵的秩

使用NumPy中的线性代数方法matrix_rank计算矩阵的秩。

## 1.13 计算行列式

使用NumPy的线性代数方法det计算行列式。

## 1.14 矩阵的对角元素

## 1.15 矩阵的迹

矩阵的迹是其对角线元素之和，常被用于机器学习底层计算中。NumPy的trace方法计算。

### 1.16 特征值与特征向量

- 特征值分解可以得到特征值(eigenvalues)与特征向量(eigenvectors)；
- 特征值表示的是这个特征到底有多重要，而特征向量表示这个特征是什么。

如果说一个向量$\vec{v}$是方阵$A$的特征向量，将一定可以表示成下面的形式：

$$ A\nu = \lambda \nu $$

$\lambda$为特征向量$\vec{v}$对应的特征值。特征值分解是将一个矩阵分解为如下形式：

$$ A=Q\sum Q^{-1} $$

其中，$Q$是这个矩阵$A$的特征向量组成的矩阵，$\sum$是一个对角矩阵，每一个对角线元素就是一个特征值，里面的特征值是由大到小排列的，这些特征值所对应的特征向量就是描述这个矩阵变化方向（从主要的变化到次要的变化排列）。**也就是说矩阵$A$的信息可以由其特征值和特征向量表示**。

在NumPy中使用线性代数计算方法eig函数返回特征值和特征向量。

## 1.17 计算点积

向量$\vec{a}$和向量$\vec{b}$的点积定义如下：
$$
\sum_{i=1}^{n}a_{i}b_{i}
$$


使用NumPy的dot方法计算点积，dot(a, b)

## 1.18 矩阵相加减

可以简单实用"+"与"-"，进行矩阵加减运算。

## 1.19 矩阵乘法

使用NumPy的dot方法计算矩阵乘法。注意：dot方法与两个矩阵直接相乘不同，直接相乘，是将两个矩阵对应位置的元素相乘，写入在返回矩阵的相同位置，使用“*”运算符计算。

## 1.20 矩阵的逆

假设矩阵*A*存在逆矩阵$A^{-1}$，则$A A^-1 = I$，$I$表示单位矩阵。可以使用NumPy线性代数方法inv计算。

## 1.21 生成随机数

在NumPy中可以随机生成整数，浮点数，或者从正态分布、logistic分布等中随机抽取若干个数。多次返回同样的随机数对于获取可预测、可重复的结果是非常重要的，可以设置随机数生成器的种子（Seed）来实现。相同种子的程序会生成同样的结果。21

